import numpy as np

def system_bases():
	Sb=500e6
	Vb=280e3
	Fb=50
	Ib=Sb/(np.sqrt(3)*Vb)
	Zb=Vb**2/Sb
	Wb=2*np.pi*Fb
	
	return Sb, Vb, Fb, Ib, Zb, Wb 

def pu_conversion(df):
    Sb, Vb, Fb, Ib, Zb, Wb = system_bases()
    
    df['V1_pu'] = df['V1'].apply(lambda x: x/Vb)
    df['V2_pu'] = df['V2'].apply(lambda x: x/Vb)
    df['V3_pu'] = df['V3'].apply(lambda x: x/Vb)
    df['V4_pu'] = df['V4'].apply(lambda x: x/Vb)
    df['V5_pu'] = df['V5'].apply(lambda x: x/Vb)
    df['V6_pu'] = df['V6'].apply(lambda x: x/Vb)
    df['V7_pu'] = df['V7'].apply(lambda x: x/Vb)
    df['V8_pu'] = df['V8'].apply(lambda x: x/Vb)
    df['V9_pu'] = df['V9'].apply(lambda x: x/Vb)
    df['V10_pu'] = df['V10'].apply(lambda x: x/Vb)
    df['V11_pu'] = df['V11'].apply(lambda x: x/Vb)
    df['V1dc_pu'] = df['V1dc'].apply(lambda x: x/Vb)
    df['V2dc_pu'] = df['V2dc'].apply(lambda x: x/Vb)
    df['V3dc_pu'] = df['V3dc'].apply(lambda x: x/Vb)
    df['V4dc_pu'] = df['V4dc'].apply(lambda x: x/Vb)
    df['V5dc_pu'] = df['V5dc'].apply(lambda x: x/Vb)
    df['V6dc_pu'] = df['V6dc'].apply(lambda x: x/Vb)
    df['vq0_1_pu'] = df['vq0_1'].apply(lambda x: x/Vb)
    df['vd0_1_pu'] = df['vd0_1'].apply(lambda x: x/Vb)
    df['vq0c_1_pu'] = df['vq0c_1'].apply(lambda x: x/Vb)
    df['vd0c_1_pu'] = df['vd0c_1'].apply(lambda x: x/Vb)
    df['vq0_2_pu'] = df['vq0_2'].apply(lambda x: x/Vb)
    df['vd0_2_pu'] = df['vd0_2'].apply(lambda x: x/Vb)
    df['vq0c_2_pu'] = df['vq0c_2'].apply(lambda x: x/Vb)
    df['vd0c_2_pu'] = df['vd0c_2'].apply(lambda x: x/Vb)
    df['vq0_3_pu'] = df['vq0_3'].apply(lambda x: x/Vb)
    df['vd0_3_pu'] = df['vd0_3'].apply(lambda x: x/Vb)
    df['vq0c_3_pu'] = df['vq0c_3'].apply(lambda x: x/Vb)
    df['vd0c_3_pu'] = df['vd0c_3'].apply(lambda x: x/Vb)
    df['vq0_4_pu'] = df['vq0_4'].apply(lambda x: x/Vb)
    df['vd0_4_pu'] = df['vd0_4'].apply(lambda x: x/Vb)
    df['vq0c_4_pu'] = df['vq0c_4'].apply(lambda x: x/Vb)
    df['vd0c_4_pu'] = df['vd0c_4'].apply(lambda x: x/Vb)
    df['vq0_5_pu'] = df['vq0_5'].apply(lambda x: x/Vb)
    df['vd0_5_pu'] = df['vd0_5'].apply(lambda x: x/Vb)
    df['vq0c_5_pu'] = df['vq0c_5'].apply(lambda x: x/Vb)
    df['vd0c_5_pu'] = df['vd0c_5'].apply(lambda x: x/Vb)
    df['vq0_6_pu'] = df['vq0_6'].apply(lambda x: x/Vb)
    df['vd0_6_pu'] = df['vd0_6'].apply(lambda x: x/Vb)
    df['vq0c_6_pu'] = df['vq0c_6'].apply(lambda x: x/Vb)
    df['vd0c_6_pu'] = df['vd0c_6'].apply(lambda x: x/Vb)
    df['vq0_7_pu'] = df['vq0_7'].apply(lambda x: x/Vb)
    df['vd0_7_pu'] = df['vd0_7'].apply(lambda x: x/Vb)
    df['vq0c_7_pu'] = df['vq0c_7'].apply(lambda x: x/Vb)
    df['vd0c_7_pu'] = df['vd0c_7'].apply(lambda x: x/Vb)
    df['vnq0_mmc1_pu'] = df['vnq0_mmc1'].apply(lambda x: x/Vb)
    df['vnd0_mmc1_pu'] = df['vnd0_mmc1'].apply(lambda x: x/Vb)
    df['vnq0_c_mmc1_pu'] = df['vnq0_c_mmc1'].apply(lambda x: x/Vb)
    df['vnd0_c_mmc1_pu'] = df['vnd0_c_mmc1'].apply(lambda x: x/Vb)
    df['vdiffq0_mmc1_pu'] = df['vdiffq0_mmc1'].apply(lambda x: x/Vb)
    df['vdiffd0_mmc1_pu'] = df['vdiffd0_mmc1'].apply(lambda x: x/Vb)
    df['vdiffq0_c_mmc1_pu'] = df['vdiffq0_c_mmc1'].apply(lambda x: x/Vb)
    df['vdiffd0_c_mmc1_pu'] = df['vdiffd0_c_mmc1'].apply(lambda x: x/Vb)
    df['vsum0_mmc1_pu'] = df['vsum0_mmc1'].apply(lambda x: x/Vb)
    df['vDC0_mmc1_pu'] = df['vDC0_mmc1'].apply(lambda x: x/Vb)
    df['vnq0_mmc2_pu'] = df['vnq0_mmc2'].apply(lambda x: x/Vb)
    df['vnd0_mmc2_pu'] = df['vnd0_mmc2'].apply(lambda x: x/Vb)
    df['vnq0_c_mmc2_pu'] = df['vnq0_c_mmc2'].apply(lambda x: x/Vb)
    df['vnd0_c_mmc2_pu'] = df['vnd0_c_mmc2'].apply(lambda x: x/Vb)
    df['vdiffq0_mmc2_pu'] = df['vdiffq0_mmc2'].apply(lambda x: x/Vb)
    df['vdiffd0_mmc2_pu'] = df['vdiffd0_mmc2'].apply(lambda x: x/Vb)
    df['vdiffq0_c_mmc2_pu'] = df['vdiffq0_c_mmc2'].apply(lambda x: x/Vb)
    df['vdiffd0_c_mmc2_pu'] = df['vdiffd0_c_mmc2'].apply(lambda x: x/Vb)
    df['vsum0_mmc2_pu'] = df['vsum0_mmc2'].apply(lambda x: x/Vb)
    df['vDC0_mmc2_pu'] = df['vDC0_mmc2'].apply(lambda x: x/Vb)
    df['vnq0_mmc3_pu'] = df['vnq0_mmc3'].apply(lambda x: x/Vb)
    df['vnd0_mmc3_pu'] = df['vnd0_mmc3'].apply(lambda x: x/Vb)
    df['vnq0_c_mmc3_pu'] = df['vnq0_c_mmc3'].apply(lambda x: x/Vb)
    df['vnd0_c_mmc3_pu'] = df['vnd0_c_mmc3'].apply(lambda x: x/Vb)
    df['vdiffq0_mmc3_pu'] = df['vdiffq0_mmc3'].apply(lambda x: x/Vb)
    df['vdiffd0_mmc3_pu'] = df['vdiffd0_mmc3'].apply(lambda x: x/Vb)
    df['vdiffq0_c_mmc3_pu'] = df['vdiffq0_c_mmc3'].apply(lambda x: x/Vb)
    df['vdiffd0_c_mmc3_pu'] = df['vdiffd0_c_mmc3'].apply(lambda x: x/Vb)
    df['vsum0_mmc3_pu'] = df['vsum0_mmc3'].apply(lambda x: x/Vb)
    df['vDC0_mmc3_pu'] = df['vDC0_mmc3'].apply(lambda x: x/Vb)
    df['vnq0_mmc4_pu'] = df['vnq0_mmc4'].apply(lambda x: x/Vb)
    df['vnd0_mmc4_pu'] = df['vnd0_mmc4'].apply(lambda x: x/Vb)
    df['vnq0_c_mmc4_pu'] = df['vnq0_c_mmc4'].apply(lambda x: x/Vb)
    df['vnd0_c_mmc4_pu'] = df['vnd0_c_mmc4'].apply(lambda x: x/Vb)
    df['vdiffq0_mmc4_pu'] = df['vdiffq0_mmc4'].apply(lambda x: x/Vb)
    df['vdiffd0_mmc4_pu'] = df['vdiffd0_mmc4'].apply(lambda x: x/Vb)
    df['vdiffq0_c_mmc4_pu'] = df['vdiffq0_c_mmc4'].apply(lambda x: x/Vb)
    df['vdiffd0_c_mmc4_pu'] = df['vdiffd0_c_mmc4'].apply(lambda x: x/Vb)
    df['vsum0_mmc4_pu'] = df['vsum0_mmc4'].apply(lambda x: x/Vb)
    df['vDC0_mmc4_pu'] = df['vDC0_mmc4'].apply(lambda x: x/Vb)
    df['vnq0_mmc5_pu'] = df['vnq0_mmc5'].apply(lambda x: x/Vb)
    df['vnd0_mmc5_pu'] = df['vnd0_mmc5'].apply(lambda x: x/Vb)
    df['vnq0_c_mmc5_pu'] = df['vnq0_c_mmc5'].apply(lambda x: x/Vb)
    df['vnd0_c_mmc5_pu'] = df['vnd0_c_mmc5'].apply(lambda x: x/Vb)
    df['vdiffq0_mmc5_pu'] = df['vdiffq0_mmc5'].apply(lambda x: x/Vb)
    df['vdiffd0_mmc5_pu'] = df['vdiffd0_mmc5'].apply(lambda x: x/Vb)
    df['vdiffq0_c_mmc5_pu'] = df['vdiffq0_c_mmc5'].apply(lambda x: x/Vb)
    df['vdiffd0_c_mmc5_pu'] = df['vdiffd0_c_mmc5'].apply(lambda x: x/Vb)
    df['vsum0_mmc5_pu'] = df['vsum0_mmc5'].apply(lambda x: x/Vb)
    df['vDC0_mmc5_pu'] = df['vDC0_mmc5'].apply(lambda x: x/Vb)
    df['vnq0_mmc6_pu'] = df['vnq0_mmc6'].apply(lambda x: x/Vb)
    df['vnd0_mmc6_pu'] = df['vnd0_mmc6'].apply(lambda x: x/Vb)
    df['vnq0_c_mmc6_pu'] = df['vnq0_c_mmc6'].apply(lambda x: x/Vb)
    df['vnd0_c_mmc6_pu'] = df['vnd0_c_mmc6'].apply(lambda x: x/Vb)
    df['vdiffq0_mmc6_pu'] = df['vdiffq0_mmc6'].apply(lambda x: x/Vb)
    df['vdiffd0_mmc6_pu'] = df['vdiffd0_mmc6'].apply(lambda x: x/Vb)
    df['vdiffq0_c_mmc6_pu'] = df['vdiffq0_c_mmc6'].apply(lambda x: x/Vb)
    df['vdiffd0_c_mmc6_pu'] = df['vdiffd0_c_mmc6'].apply(lambda x: x/Vb)
    df['vsum0_mmc6_pu'] = df['vsum0_mmc6'].apply(lambda x: x/Vb)
    df['vDC0_mmc6_pu'] = df['vDC0_mmc6'].apply(lambda x: x/Vb)
    df['vq0_th1_pu'] = df['vq0_th1'].apply(lambda x: x/Vb)
    df['vd0_th1_pu'] = df['vd0_th1'].apply(lambda x: x/Vb)
    df['vq0_th2_pu'] = df['vq0_th2'].apply(lambda x: x/Vb)
    df['vd0_th2_pu'] = df['vd0_th2'].apply(lambda x: x/Vb)
    df['Pth1_pu'] = df['Pth1'].apply(lambda x: x/Sb)
    df['Pmmc1_pu'] = df['Pmmc1'].apply(lambda x: x/Sb)
    df['Pg1_pu'] = df['Pg1'].apply(lambda x: x/Sb)
    df['Pmmc2_pu'] = df['Pmmc2'].apply(lambda x: x/Sb)
    df['Pmmc4_pu'] = df['Pmmc4'].apply(lambda x: x/Sb)
    df['Pmmc3_pu'] = df['Pmmc3'].apply(lambda x: x/Sb)
    df['Pl7_pu'] = df['Pl7'].apply(lambda x: x/Sb)
    df['Pth2_pu'] = df['Pth2'].apply(lambda x: x/Sb)
    df['Pmmc6_pu'] = df['Pmmc6'].apply(lambda x: x/Sb)
    df['Pmmc5_pu'] = df['Pmmc5'].apply(lambda x: x/Sb)
    df['Pg3_pu'] = df['Pg3'].apply(lambda x: x/Sb)
    df['Pg2_pu'] = df['Pg2'].apply(lambda x: x/Sb)
    df['Pl2_pu'] = df['Pl2'].apply(lambda x: x/Sb)
    df['Pl5_pu'] = df['Pl5'].apply(lambda x: x/Sb)
    df['Pl9_pu'] = df['Pl9'].apply(lambda x: x/Sb)
    df['Qth1_pu'] = df['Qth1'].apply(lambda x: x/Sb)
    df['Qmmc1_pu'] = df['Qmmc1'].apply(lambda x: x/Sb)
    df['Qg1_pu'] = df['Qg1'].apply(lambda x: x/Sb)
    df['Qmmc2_pu'] = df['Qmmc2'].apply(lambda x: x/Sb)
    df['Qmmc4_pu'] = df['Qmmc4'].apply(lambda x: x/Sb)
    df['Qmmc3_pu'] = df['Qmmc3'].apply(lambda x: x/Sb)
    df['Ql7_pu'] = df['Ql7'].apply(lambda x: x/Sb)
    df['Qth2_pu'] = df['Qth2'].apply(lambda x: x/Sb)
    df['Qmmc6_pu'] = df['Qmmc6'].apply(lambda x: x/Sb)
    df['Qmmc5_pu'] = df['Qmmc5'].apply(lambda x: x/Sb)
    df['Qg3_pu'] = df['Qg3'].apply(lambda x: x/Sb)
    df['Qg2_pu'] = df['Qg2'].apply(lambda x: x/Sb)
    df['Ql2_pu'] = df['Ql2'].apply(lambda x: x/Sb)
    df['Ql5_pu'] = df['Ql5'].apply(lambda x: x/Sb)
    df['Ql9_pu'] = df['Ql9'].apply(lambda x: x/Sb)
    df['P1dc_pu'] = df['P1dc'].apply(lambda x: x/Sb)
    df['P2dc_pu'] = df['P2dc'].apply(lambda x: x/Sb)
    df['P3dc_pu'] = df['P3dc'].apply(lambda x: x/Sb)
    df['P4dc_pu'] = df['P4dc'].apply(lambda x: x/Sb)
    df['P5dc_pu'] = df['P5dc'].apply(lambda x: x/Sb)
    df['P6dc_pu'] = df['P6dc'].apply(lambda x: x/Sb)
    df['P_1_pu'] = df['P_1'].apply(lambda x: x/Sb)
    df['Q_1_pu'] = df['Q_1'].apply(lambda x: x/Sb)
    df['P_2_pu'] = df['P_2'].apply(lambda x: x/Sb)
    df['Q_2_pu'] = df['Q_2'].apply(lambda x: x/Sb)
    df['P_3_pu'] = df['P_3'].apply(lambda x: x/Sb)
    df['Q_3_pu'] = df['Q_3'].apply(lambda x: x/Sb)
    df['P_4_pu'] = df['P_4'].apply(lambda x: x/Sb)
    df['Q_4_pu'] = df['Q_4'].apply(lambda x: x/Sb)
    df['P_5_pu'] = df['P_5'].apply(lambda x: x/Sb)
    df['Q_5_pu'] = df['Q_5'].apply(lambda x: x/Sb)
    df['P_6_pu'] = df['P_6'].apply(lambda x: x/Sb)
    df['Q_6_pu'] = df['Q_6'].apply(lambda x: x/Sb)
    df['P_7_pu'] = df['P_7'].apply(lambda x: x/Sb)
    df['Q_7_pu'] = df['Q_7'].apply(lambda x: x/Sb)
    df['iq0_1_pu'] = df['iq0_1'].apply(lambda x: x/Ib)
    df['id0_1_pu'] = df['id0_1'].apply(lambda x: x/Ib)
    df['iq0c_1_pu'] = df['iq0c_1'].apply(lambda x: x/Ib)
    df['id0c_1_pu'] = df['id0c_1'].apply(lambda x: x/Ib)
    df['iq0_2_pu'] = df['iq0_2'].apply(lambda x: x/Ib)
    df['id0_2_pu'] = df['id0_2'].apply(lambda x: x/Ib)
    df['iq0c_2_pu'] = df['iq0c_2'].apply(lambda x: x/Ib)
    df['id0c_2_pu'] = df['id0c_2'].apply(lambda x: x/Ib)
    df['iq0_3_pu'] = df['iq0_3'].apply(lambda x: x/Ib)
    df['id0_3_pu'] = df['id0_3'].apply(lambda x: x/Ib)
    df['iq0c_3_pu'] = df['iq0c_3'].apply(lambda x: x/Ib)
    df['id0c_3_pu'] = df['id0c_3'].apply(lambda x: x/Ib)
    df['iq0_4_pu'] = df['iq0_4'].apply(lambda x: x/Ib)
    df['id0_4_pu'] = df['id0_4'].apply(lambda x: x/Ib)
    df['iq0c_4_pu'] = df['iq0c_4'].apply(lambda x: x/Ib)
    df['id0c_4_pu'] = df['id0c_4'].apply(lambda x: x/Ib)
    df['iq0_5_pu'] = df['iq0_5'].apply(lambda x: x/Ib)
    df['id0_5_pu'] = df['id0_5'].apply(lambda x: x/Ib)
    df['iq0c_5_pu'] = df['iq0c_5'].apply(lambda x: x/Ib)
    df['id0c_5_pu'] = df['id0c_5'].apply(lambda x: x/Ib)
    df['iq0_6_pu'] = df['iq0_6'].apply(lambda x: x/Ib)
    df['id0_6_pu'] = df['id0_6'].apply(lambda x: x/Ib)
    df['iq0c_6_pu'] = df['iq0c_6'].apply(lambda x: x/Ib)
    df['id0c_6_pu'] = df['id0c_6'].apply(lambda x: x/Ib)
    df['iq0_7_pu'] = df['iq0_7'].apply(lambda x: x/Ib)
    df['id0_7_pu'] = df['id0_7'].apply(lambda x: x/Ib)
    df['iq0c_7_pu'] = df['iq0c_7'].apply(lambda x: x/Ib)
    df['id0c_7_pu'] = df['id0c_7'].apply(lambda x: x/Ib)
    df['idiffq0_mmc1_pu'] = df['idiffq0_mmc1'].apply(lambda x: x/Ib)
    df['idiffd0_mmc1_pu'] = df['idiffd0_mmc1'].apply(lambda x: x/Ib)
    df['idiffq0_c_mmc1_pu'] = df['idiffq0_c_mmc1'].apply(lambda x: x/Ib)
    df['idiffd0_c_mmc1_pu'] = df['idiffd0_c_mmc1'].apply(lambda x: x/Ib)
    df['isum0_mmc1_pu'] = df['isum0_mmc1'].apply(lambda x: x/Ib)
    df['idiffq0_mmc2_pu'] = df['idiffq0_mmc2'].apply(lambda x: x/Ib)
    df['idiffd0_mmc2_pu'] = df['idiffd0_mmc2'].apply(lambda x: x/Ib)
    df['idiffq0_c_mmc2_pu'] = df['idiffq0_c_mmc2'].apply(lambda x: x/Ib)
    df['idiffd0_c_mmc2_pu'] = df['idiffd0_c_mmc2'].apply(lambda x: x/Ib)
    df['isum0_mmc2_pu'] = df['isum0_mmc2'].apply(lambda x: x/Ib)
    df['idiffq0_mmc3_pu'] = df['idiffq0_mmc3'].apply(lambda x: x/Ib)
    df['idiffd0_mmc3_pu'] = df['idiffd0_mmc3'].apply(lambda x: x/Ib)
    df['idiffq0_c_mmc3_pu'] = df['idiffq0_c_mmc3'].apply(lambda x: x/Ib)
    df['idiffd0_c_mmc3_pu'] = df['idiffd0_c_mmc3'].apply(lambda x: x/Ib)
    df['isum0_mmc3_pu'] = df['isum0_mmc3'].apply(lambda x: x/Ib)
    df['idiffq0_mmc4_pu'] = df['idiffq0_mmc4'].apply(lambda x: x/Ib)
    df['idiffd0_mmc4_pu'] = df['idiffd0_mmc4'].apply(lambda x: x/Ib)
    df['idiffq0_c_mmc4_pu'] = df['idiffq0_c_mmc4'].apply(lambda x: x/Ib)
    df['idiffd0_c_mmc4_pu'] = df['idiffd0_c_mmc4'].apply(lambda x: x/Ib)
    df['isum0_mmc4_pu'] = df['isum0_mmc4'].apply(lambda x: x/Ib)
    df['idiffq0_mmc5_pu'] = df['idiffq0_mmc5'].apply(lambda x: x/Ib)
    df['idiffd0_mmc5_pu'] = df['idiffd0_mmc5'].apply(lambda x: x/Ib)
    df['idiffq0_c_mmc5_pu'] = df['idiffq0_c_mmc5'].apply(lambda x: x/Ib)
    df['idiffd0_c_mmc5_pu'] = df['idiffd0_c_mmc5'].apply(lambda x: x/Ib)
    df['isum0_mmc5_pu'] = df['isum0_mmc5'].apply(lambda x: x/Ib)
    df['idiffq0_mmc6_pu'] = df['idiffq0_mmc6'].apply(lambda x: x/Ib)
    df['idiffd0_mmc6_pu'] = df['idiffd0_mmc6'].apply(lambda x: x/Ib)
    df['idiffq0_c_mmc6_pu'] = df['idiffq0_c_mmc6'].apply(lambda x: x/Ib)
    df['idiffd0_c_mmc6_pu'] = df['idiffd0_c_mmc6'].apply(lambda x: x/Ib)
    df['isum0_mmc6_pu'] = df['isum0_mmc6'].apply(lambda x: x/Ib)
    df['iq0_th1_pu'] = df['iq0_th1'].apply(lambda x: x/Ib)
    df['id0_th1_pu'] = df['id0_th1'].apply(lambda x: x/Ib)
    df['iq0_th2_pu'] = df['iq0_th2'].apply(lambda x: x/Ib)
    df['id0_th2_pu'] = df['id0_th2'].apply(lambda x: x/Ib)
    
    return df
    
    
